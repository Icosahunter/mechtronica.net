---
layout: template.njk
title: MechDB Viewer
permalink: mechdb/builder/
---
<style>
    .joint {
        position: absolute;
        width: 7.5%;
    }

    .slot {
        position: absolute;
        width: 14%;
        height: 14%;
    }

    .slot > img {
        width: 100%;
    }

    .slot > p {
        font-size: medium;
        color: black;
        margin: 5%;
        position: absolute;
        top: 0;
    }

    .slot:hover {
        filter: brightness(200%);
    }

    .content-wrapper {
        overflow-y: hidden;
    }

    .selected_slot {
        border-radius: 15%;
        border: 3px solid yellow;
    }

</style>
<div class="d-flex flex-row">
    <div class="d-flex flex-column" style="width: 30%;">
        <table>
            <th></th>
            <th>Available</th>
            <th>Used</th>
            <th>Excess</th>
            <tr>
                <th>Power</th>
                <td id="available-power"></td>
                <td id="used-power"></td>
                <td id="excess-power"></td>
            </tr>
            <tr>
                <th>Cooling</th>
                <td id="available-cooling"></td>
                <td id="used-cooling"></td>
                <td id="excess-cooling"></td>
            </tr>
            <tr>
                <th>CPU</th>
                <td id="available-cpu"></td>
                <td id="used-cpu"></td>
                <td id="excess-cpu"></td>
            </tr>
        </table>
        <div class="position-relative">
            <img style="margin-top: 7%; width: 100%;" src="{{site.url}}/images/frames/standard-background.svg">
            <!-- Left Arm -->
            <div id="LJ" class="joint" style="top: 15%; left: 19%;">
                <img src="{{site.url}}/images/frames/joint-background.svg">
                <p></p>
            </div>
            <div id="L1" class="slot" style="top: 10%; left: 3%;">
                <img src="{{site.url}}/images/frames/slot-background.svg" onclick="slot_click('L1');">
                <p></p>
            </div>
            <div id="L2" class="slot" style="top: 34%; left: 3%;">
                <img src="{{site.url}}/images/frames/slot-background.svg" onclick="slot_click('L2');">
                <p></p>
            </div>
            
            <!-- Right Arm -->
            <div id="RJ" class="joint" style="top: 15%; right: 19%;">
                <img src="{{site.url}}/images/frames/joint-background.svg">
                <p></p>
            </div>
            <div id="R1" class="slot" style="top: 10%; right: 3%;">
                <img src="{{site.url}}/images/frames/slot-background.svg" onclick="slot_click('R1');">
                <p></p>
            </div>
            <div id="R2" class="slot" style="top: 34%; right: 3%;">
                <img src="{{site.url}}/images/frames/slot-background.svg" onclick="slot_click('R2');">
                <p></p>
            </div>
            
            <!-- Torso -->
            <div id="T1" class="slot" style="top: 0; left: 28%;">
                <img src="{{site.url}}/images/frames/slot-background.svg" onclick="slot_click('T1');">
                <p></p>
            </div>
            <div id="T2" class="slot" style="top: 0; right: 28%;">
                <img src="{{site.url}}/images/frames/slot-background.svg" onclick="slot_click('T2');">
                <p></p>
            </div>
            <div id="T3" class="slot" style="top: 17%; left: 28%;">
                <img src="{{site.url}}/images/frames/slot-background.svg" onclick="slot_click('T3');">
                <p></p>
            </div>
            <div id="T4" class="slot" style="top: 17%; right: 28%;">
                <img src="{{site.url}}/images/frames/slot-background.svg" onclick="slot_click('T4');">
                <p></p>
            </div>
            <div id="T5" class="slot" style="top: 28%; left: 43%;">
                <img src="{{site.url}}/images/frames/slot-background.svg" onclick="slot_click('T5');">
                <p></p>
            </div>
            <div id="T6" class="slot" style="top: 34%; left: 28%;">
                <img src="{{site.url}}/images/frames/slot-background.svg" onclick="slot_click('T6');">
                <p></p>
            </div>
            <div id="T7" class="slot" style="top: 34%; right: 28%;">
                <img src="{{site.url}}/images/frames/slot-background.svg" onclick="slot_click('T7');">
                <p></p>
            </div>
            
            <!-- Legs -->
            <div id="BJ" class="joint" style="top: 50%; left: 46.5%;">
                <img src="{{site.url}}/images/frames/joint-background.svg">
                <p></p>
            </div>
            <div id="B1" class="slot" style="top: 58%; left: 17%;">
                <img src="{{site.url}}/images/frames/slot-background.svg" onclick="slot_click('B1');">
                <p></p>
            </div>
            <div id="B2" class="slot" style="top: 58%; right: 17%;">
                <img src="{{site.url}}/images/frames/slot-background.svg" onclick="slot_click('B2');">
                <p></p>
            </div>
        </div>
    </div>
    <div style="width: 60%;">
        <div class="d-flex m-10">
            <p class="m-0 mr-10">Search: </p>
            <input type='search' class='form-control' id='mechdb-search' placeholder='Search MechDB'>
        </div>
        <div class="d-flex m-10">
            <p class="m-0 mr-10">Filter by type: </p>
            <select class="form-control w-200" id="type-select" onchange="onchange_typeselect()">
                <option value="" selected="selected" disabled="disabled">Select</option>
                <option value="Frame">Frame</option>
                <option value="Plating">Plating</option>
                <option value="Cabin">Cabin</option>
                <option value="Mainframe">Mainframe</option>
                <option value="Module">Module</option>
                <option value="Cooler">Cooler</option>
                <option value="Power Plant">Power Plant</option>
                <option value="Tank">Tank</option>
                <option value="Weapon">Weapon</option>
                <option value="Equipment">Equipment</option>
            </select>
        </div>
        <div class="overflow-y-scroll" style="height: calc(100vh - 25rem);">
            <table class='table' id='results'></table>
        </div>
    </div>
</div>

<script>
    components = {};
    selected_slot = null;
    available_p = {
        'pwr': document.getElementById('available-power'),
        'cool': document.getElementById('available-cooling'),
        'cpu': document.getElementById('available-cpu')
    }
    used_p = {
        'pwr': document.getElementById('used-power'),
        'cool': document.getElementById('used-cooling'),
        'cpu': document.getElementById('used-cpu')
    }
    excess_p = {
        'pwr': document.getElementById('excess-power'),
        'cool': document.getElementById('excess-cooling'),
        'cpu': document.getElementById('excess-cpu')
    }

    function slot_click(slot) {
        if (selected_slot != null) {
            document.getElementById(selected_slot).classList.remove('selected_slot');
        }
        selected_slot = slot;
        document.getElementById(selected_slot).classList.add('selected_slot');
    }

    function calculate_resources() {
        available = {'pwr': 0, 'cool': 0, 'cpu': 0};
        used = {'pwr': 0, 'cool': 0, 'cpu': 0};
        excess = {'pwr': 0, 'cool': 0, 'cpu': 0};
        for (let x of ['pwr', 'cool', 'cpu']) {
            for (let slot in components) {
                if (components[slot] != null) {
                    if (x in components[slot]) {
                        if (components[slot][x] > 0) {
                            available[x] += parseInt(components[slot][x]);
                        }
                        else {
                            used[x] -= parseInt(components[slot][x]);
                        }
                    }
                }
            }
            excess[x] = available[x] - used[x];
            available_p[x].innerHTML = available[x];
            used_p[x].innerHTML = used[x];
            excess_p[x].innerHTML = excess[x];
        }
        
    }

    function partClick(name) {
        components[selected_slot] = (jsonPath(data, '$[?(@.name=="' + name + '")]')[0]);
        document.getElementById(selected_slot).children[1].innerHTML = name;
        calculate_resources();
    }

</script>
<script src='{{site.url}}/jsonpath-0.8.0.js'></script>
<script src='{{site.url}}/mechdb.js'></script>